# 蔵書管理システム 要件定義書（Phase 2完了版）

## 1. プロジェクト概要
### 1.1 システム名
蔵書管理システム

### 1.2 目的
個人または小規模組織での書籍管理を効率化し、読書状況の把握と書籍検索の利便性を向上させる

### 1.3 実装状況サマリー
- **Phase 1**: 環境構築 ✅ 完了
- **Phase 2**: バックエンド実装 ✅ 完了
- **Phase 3**: フロントエンド実装 ⏳ 次フェーズ
- **Phase 4**: 統合・テスト ⏳ 待機中

## 2. 機能要件（実装状況付き）

### 2.1 書籍管理機能 ✅ バックエンド実装完了
#### 2.1.1 書籍登録 ✅ API実装完了
- **機能**: 新しい書籍を登録する
- **実装状況**: BookController::store() ✅
- **バリデーション**: StoreBookRequest ✅
- **入力項目**: 
  - タイトル（必須）
  - 著者（必須）
  - 出版社（任意）
  - 出版年（任意、1000-2100年）
  - ISBN（任意）
  - カテゴリ（任意）
  - 読書状況（必須、enum: unread/reading/read）

#### 2.1.2 書籍一覧表示 ✅ API実装・動作確認完了
- **機能**: 登録された書籍の一覧を表示する
- **実装状況**: BookController::index() ✅
- **動作確認**: GET /api/books ✅
- **ページネーション**: 20件/ページ ✅
- **テストデータ**: 3件投入済み ✅

#### 2.1.3 書籍詳細表示 ✅ API実装完了
- **機能**: 選択した書籍の詳細情報を表示する
- **実装状況**: BookController::show() ✅
- **レスポンス**: BookResource形式 ✅

#### 2.1.4 書籍編集 ✅ API実装完了
- **機能**: 既存の書籍情報を編集する
- **実装状況**: BookController::update() ✅
- **バリデーション**: UpdateBookRequest ✅

#### 2.1.5 書籍削除 ✅ API実装完了
- **機能**: 不要な書籍を削除する
- **実装状況**: BookController::destroy() ✅
- **レスポンス**: 204 No Content ✅

### 2.2 検索・絞り込み機能 ✅ バックエンド実装完了
#### 2.2.1 フリーワード検索 ✅ 実装完了
- **機能**: タイトルまたは著者名での部分一致検索
- **実装状況**: Book::scopeSearch() ✅
- **検索対象**: title, author フィールド ✅

#### 2.2.2 カテゴリフィルター ✅ 実装完了
- **機能**: カテゴリによる絞り込み
- **実装状況**: Book::scopeCategory() ✅

#### 2.2.3 読書状況フィルター ✅ 実装完了
- **機能**: 読書状況による絞り込み
- **実装状況**: Book::scopeReadingStatus() ✅
- **選択肢**: 未読、読書中、既読 ✅

#### 2.2.4 ソート機能 ✅ 実装完了
- **機能**: 各項目での並び替え
- **実装状況**: BookController::index()内 ✅
- **ソート項目**: 作成日時、タイトル、著者 ✅

### 2.3 ユーザーインターフェース ⏳ Phase 3で実装予定
#### 2.3.1 レスポンシブデザイン ⏳ 実装予定
- **機能**: PC・タブレット・スマートフォン対応
- **技術**: Tailwind CSS使用予定
- **ブレークポイント**: 
  - Mobile: < 768px
  - Tablet: 768px - 1024px  
  - Desktop: > 1024px

#### 2.3.2 書籍カード表示 ⏳ 実装予定
- **機能**: 書籍情報をカード形式で表示
- **表示項目**: タイトル、著者、読書状況、カテゴリ
- **アクション**: 詳細表示、編集、削除

#### 2.3.3 検索インターフェース ⏳ 実装予定
- **機能**: リアルタイム検索とフィルター
- **実装予定**: SearchBox.vue
- **機能**: デバウンス処理、最小文字数制限

## 3. 非機能要件

### 3.1 パフォーマンス要件
#### 3.1.1 レスポンス時間 ✅ 目標達成
- **API応答時間**: 100ms以下 ✅ 実測値達成
- **検索処理**: 200ms以下（目標）
- **ページ読み込み**: 2秒以下（目標）

#### 3.1.2 データ処理 ✅ 実装完了
- **ページネーション**: 20件/ページ ✅
- **同時接続**: 10ユーザー程度（小規模想定）
- **データベース**: SQLiteによる軽量化 ✅

### 3.2 セキュリティ要件 ✅ 基本実装完了
#### 3.2.1 入力検証 ✅ 実装完了
- **バリデーション**: Laravel Request Validation ✅
- **サニタイゼーション**: Eloquent ORM使用 ✅
- **XSS防止**: Vue.js自動エスケープ（Phase 3で実装予定）

#### 3.2.2 CSRF保護 ⏳ Phase 3で実装予定
- **実装方式**: Laravel Sanctum使用予定
- **トークン管理**: SPA認証

### 3.3 可用性要件
#### 3.3.1 データ保護 ✅ 実装完了
- **データベース**: SQLiteファイルベース ✅
- **バックアップ**: ファイルコピーで対応可能 ✅

#### 3.3.2 エラーハンドリング
- **API**: 適切なHTTPステータスコード ✅
- **フロントエンド**: エラーメッセージ表示（Phase 3で実装予定）

## 4. 技術要件（確定版）

### 4.1 システム構成 ✅ 確定
- **アーキテクチャ**: SPA（Single Page Application）
- **通信方式**: RESTful API
- **データベース**: SQLite ✅ 実装済み
- **認証**: なし（シンプル構成）

### 4.2 使用技術（確定版）
#### 4.2.1 バックエンド ✅ 実装完了
- **フレームワーク**: Laravel 12 ✅
- **言語**: PHP 8.1以上 ✅
- **データベース**: SQLite ✅
- **API**: RESTful API + Laravel Resources ✅

#### 4.2.2 フロントエンド ⏳ Phase 3実装予定
- **フレームワーク**: Vue.js 3 + Composition API
- **ルーティング**: Vue Router 4
- **状態管理**: Pinia
- **スタイル**: Tailwind CSS
- **ビルドツール**: Vite
- **アイコン**: Heroicons

#### 4.2.3 開発ツール ✅ 設定済み
- **バックエンド**: Composer, Artisan ✅
- **フロントエンド**: npm, Vite
- **バージョン管理**: Git（推奨）

### 4.3 API仕様（実装完了）
#### 4.3.1 エンドポイント ✅ 全て実装完了
```
GET    /api/books              - 書籍一覧取得 ✅
POST   /api/books              - 書籍登録 ✅
GET    /api/books/{id}         - 書籍詳細取得 ✅
PUT    /api/books/{id}         - 書籍更新 ✅
DELETE /api/books/{id}         - 書籍削除 ✅
```

#### 4.3.2 リクエスト・レスポンス形式 ✅ 実装確認済み
- **Content-Type**: application/json
- **文字コード**: UTF-8
- **ページネーション**: Laravel標準形式 ✅
- **エラーレスポンス**: 標準HTTPステータスコード ✅

## 5. データ要件（実装完了）

### 5.1 書籍データ ✅ 実装完了
```php
// Book Model - 実装済み
id: integer (Primary Key, Auto Increment) ✅
title: string(255, Required) ✅
author: string(255, Required) ✅
publisher: string(255, Nullable) ✅
publication_year: integer(Nullable, 1000-2100) ✅
isbn: string(20, Nullable) ✅
category: string(100, Nullable) ✅
reading_status: enum('unread','reading','read', Required) ✅
created_at: timestamp ✅
updated_at: timestamp ✅
```

### 5.2 読書状況マスタ ✅ 実装完了
```php
// ReadingStatus Enum - 実装済み
UNREAD = 'unread' -> '未読' ✅
READING = 'reading' -> '読書中' ✅  
READ = 'read' -> '既読' ✅
```

### 5.3 初期データ ✅ 投入済み
- Laravel実践入門（技術書、既読）✅
- Vue.js 3 完全ガイド（技術書、読書中）✅
- 1984年（小説、既読）✅

## 6. 運用要件

### 6.1 システム環境（確定）
- **OS**: Windows/macOS/Linux（開発環境依存）
- **Webサーバー**: PHP Built-in Server（開発用）✅
- **データベース**: SQLite（ファイルベース）✅
- **ブラウザ**: Chrome, Firefox, Safari, Edge（モダンブラウザ）

### 6.2 デプロイ要件（将来対応）
- **本番環境**: Apache/Nginx + PHP-FPM（将来的に）
- **データベース**: SQLite継続使用可能
- **SSL**: HTTPS対応（本番時）

## 7. 制約事項

### 7.1 機能制約（現バージョン）
- **ユーザー管理**: なし（シンプル構成）
- **ファイルアップロード**: なし（書影画像等）
- **バックアップ機能**: 手動（SQLiteファイルコピー）
- **インポート/エクスポート**: Phase 4で検討

### 7.2 技術制約
- **データベース**: SQLite（軽量化優先）
- **同時接続**: 小規模利用想定（1-10ユーザー）
- **ストレージ**: ローカルファイルシステム依存

## 8. Phase 3実装予定項目

### 8.1 優先度：高
1. **Vue.js基盤設定**: app.js, router, Pinia設定
2. **レイアウトコンポーネント**: Header, Sidebar, Footer
3. **書籍一覧ページ**: API統合、BookCard表示
4. **書籍登録フォーム**: バリデーション、API連携
5. **検索・フィルター**: リアルタイム検索UI

### 8.2 優先度：中
1. **書籍詳細・編集ページ**: CRUD操作完成
2. **レスポンシブデザイン**: Tailwind CSS調整
3. **エラーハンドリング**: トーストメッセージ等
4. **ページネーション**: UI実装

### 8.3 Phase 4検討項目
1. **パフォーマンス最適化**
2. **ユーザビリティ改善**
3. **テスト実装**
4. **本番環境対応**

## 9. 成功基準（Phase 2達成済み）

### 9.1 Phase 2成功基準 ✅ 達成
- [x] 全APIエンドポイント実装完了
- [x] SQLiteデータベース動作確認
- [x] テストデータ投入・API応答確認
- [x] バリデーション機能動作確認
- [x] Laravel 12環境での安定動作

### 9.2 Phase 3成功基準（目標）
- [ ] 書籍一覧・登録・編集・削除のUI実装
- [ ] 検索・フィルター機能のUI実装  
- [ ] レスポンシブデザイン対応
- [ ] API統合による完全なCRUD操作
- [ ] エラーハンドリングとユーザビリティ

### 9.3 最終成功基準（目標）
- [ ] 完全に動作するSPAアプリケーション
- [ ] 直感的で使いやすいユーザーインターフェース
- [ ] モバイル・デスクトップ両対応
- [ ] 10-100件程度の書籍管理で快適な操作性